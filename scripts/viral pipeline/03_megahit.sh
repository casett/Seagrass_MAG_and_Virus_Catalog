#!/bin/bash -l
#
#SBATCH -n 24 #number cores
#SBATCH -e logs/megahit.log
#SBATCH -o logs/megahit.log
#SBATCH --mem 600G #memory per node in Gb
#SBATCH -p highmem
#SBATCH -J virus_megahit

module load megahit
CPU=24
DIR=data/filtered
SAMPLEFILE=data/sra_samples.csv
OUT=data/megahit_assemblies

#mkdir $OUT

#SOGIN

megahit -1 $DIR/ERR4579589/ERR4579589_1_filtered.fastq,$DIR/ERR4579590/ERR4579590_1_filtered.fastq,$DIR/ERR4579591/ERR4579591_1_filtered.fastq,$DIR/ERR4579592/ERR4579592_1_filtered.fastq,$DIR/ERR4579593/ERR4579593_1_filtered.fastq,$DIR/ERR4579594/ERR4579594_1_filtered.fastq,$DIR/ERR4579595/ERR4579595_1_filtered.fastq,$DIR/ERR4579596/ERR4579596_1_filtered.fastq,$DIR/ERR4579597/ERR4579597_1_filtered.fastq -2 $DIR/ERR4579589/ERR4579589_2_filtered.fastq,$DIR/ERR4579590/ERR4579590_2_filtered.fastq,$DIR/ERR4579591/ERR4579591_2_filtered.fastq,$DIR/ERR4579592/ERR4579592_2_filtered.fastq,$DIR/ERR4579593/ERR4579593_2_filtered.fastq,$DIR/ERR4579594/ERR4579594_2_filtered.fastq,$DIR/ERR4579595/ERR4579595_2_filtered.fastq,$DIR/ERR4579596/ERR4579596_2_filtered.fastq,$DIR/ERR4579597/ERR4579597_2_filtered.fastq -o ${OUT}/SOGIN -t $CPU

#CUCIO


megahit -1 $DIR/SRR6350024/SRR6350024_1_filtered.fastq,$DIR/SRR6350025/SRR6350025_1_filtered.fastq -2 $DIR/SRR6350024/SRR6350024_2_filtered.fastq,$DIR/SRR6350025/SRR6350025_2_filtered.fastq -o $OUT/CUCIO -t $CPU


#FRASER


megahit -r $DIR/SRR6876832/SRR6876832_interleaved_filtered.fastq,$DIR/SRR6876833/SRR6876833_interleaved_filtered.fastq,$DIR/SRR6876834/SRR6876834_interleaved_filtered.fastq,$DIR/SRR6876835/SRR6876835_interleaved_filtered.fastq,$DIR/SRR6876836/SRR6876836_interleaved_filtered.fastq,$DIR/SRR6876837/SRR6876837_interleaved_filtered.fastq,$DIR/SRR6876838/SRR6876838_interleaved_filtered.fastq,$DIR/SRR6876839/SRR6876839_interleaved_filtered.fastq,$DIR/SRR6876840/SRR6876840_interleaved_filtered.fastq,$DIR/SRR6876841/SRR6876841_interleaved_filtered.fastq,$DIR/SRR6876842/SRR6876842_interleaved_filtered.fastq,$DIR/SRR6876843/SRR6876843_interleaved_filtered.fastq,$DIR/SRR6876844/SRR6876844_interleaved_filtered.fastq,$DIR/SRR6876845/SRR6876845_interleaved_filtered.fastq,$DIR/SRR6876846/SRR6876846_interleaved_filtered.fastq,$DIR/SRR6876847/SRR6876847_interleaved_filtered.fastq,$DIR/SRR6876848/SRR6876848_interleaved_filtered.fastq,$DIR/SRR6876849/SRR6876849_interleaved_filtered.fastq -o $OUT/FRASER -t $CPU

#CRUMP


megahit -1 $DIR/SRR6310506/SRR6310506_1_filtered.fastq,$DIR/SRR6310507/SRR6310507_1_filtered.fastq,$DIR/SRR6310508/SRR6310508_1_filtered.fastq,$DIR/SRR6310509/SRR6310509_1_filtered.fastq -2 $DIR/SRR6310506/SRR6310506_2_filtered.fastq,$DIR/SRR6310507/SRR6310507_2_filtered.fastq,$DIR/SRR6310508/SRR6310508_2_filtered.fastq,$DIR/SRR6310509/SRR6310509_2_filtered.fastq -o $OUT/CRUMP -t $CPU

#RUBIO-PORTILLO

megahit -1 $DIR/SRR12681089/SRR12681089_1_filtered.fastq -2 $DIR/SRR12681089/SRR12681089_2_filtered.fastq -o $OUT/RUBIO_PROTILLO/ -t $CPU

#MOHR

megahit -r $DIR/ERR6365269/ERR6365269_interleaved_filtered.fastq,$DIR/ERR6365270/ERR6365270_interleaved_filtered.fastq,$DIR/ERR6365271/ERR6365271_interleaved_filtered.fastq,$DIR/ERR6365272/ERR6365272_interleaved_filtered.fastq,$DIR/ERR6365273/ERR6365273_interleaved_filtered.fastq -o $OUT/MOHR/ -t $CPU

#SOGIN_META

megahit -1 $DIR/ERR3624084/ERR3624084_1_filtered.fastq,$DIR/ERR3624086/ERR3624086_1_filtered.fastq,$DIR/ERR3624088/ERR3624088_1_filtered.fastq,$DIR/ERR3624090/ERR3624090_1_filtered.fastq,$DIR/ERR3624092/ERR3624092_1_filtered.fastq,$DIR/ERR3624094/ERR3624094_1_filtered.fastq,$DIR/ERR3624096/ERR3624096_1_filtered.fastq,$DIR/ERR3624098/ERR3624098_1_filtered.fastq,$DIR/ERR3624100/ERR3624100_1_filtered.fastq -2 $DIR/ERR3624084/ERR3624084_2_filtered.fastq,$DIR/ERR3624086/ERR3624086_2_filtered.fastq,$DIR/ERR3624088/ERR3624088_2_filtered.fastq,$DIR/ERR3624090/ERR3624090_2_filtered.fastq,$DIR/ERR3624092/ERR3624092_2_filtered.fastq,$DIR/ERR3624094/ERR3624094_2_filtered.fastq,$DIR/ERR3624096/ERR3624096_2_filtered.fastq,$DIR/ERR3624098/ERR3624098_2_filtered.fastq,$DIR/ERR3624100/ERR3624100_2_filtered.fastq -o ${OUT}/SOGIN_META -t $CPU --k-min 23 --continue

#MIRANDA

megahit -1 $DIR/SRR18245246/SRR18245246_1_filtered.fastq,$DIR/SRR18245247/SRR18245247_1_filtered.fastq,$DIR/SRR18245248/SRR18245248_1_filtered.fastq,$DIR/SRR18245251/SRR18245251_1_filtered.fastq,$DIR/SRR18245252/SRR18245252_1_filtered.fastq,$DIR/SRR18245253/SRR18245253_1_filtered.fastq -2 $DIR/SRR18245246/SRR18245246_2_filtered.fastq,$DIR/SRR18245247/SRR18245247_2_filtered.fastq,$DIR/SRR18245248/SRR18245248_2_filtered.fastq,$DIR/SRR18245251/SRR18245251_2_filtered.fastq,$DIR/SRR18245252/SRR18245252_2_filtered.fastq,$DIR/SRR18245253/SRR18245253_2_filtered.fastq -o ${OUT}/MIRANDA -t $CPU

#SCHORN

megahit -1 $DIR/SRR17220965/SRR17220965_1_filtered.fastq,$DIR/SRR17220966/SRR17220966_1_filtered.fastq,$DIR/SRR17220967/SRR17220967_1_filtered.fastq,$DIR/SRR17220968/SRR17220968_1_filtered.fastq,$DIR/SRR17220969/SRR17220969_1_filtered.fastq,$DIR/SRR17220970/SRR17220970_1_filtered.fastq,$DIR/SRR17220971/SRR17220971_1_filtered.fastq,$DIR/SRR17220972/SRR17220972_1_filtered.fastq,$DIR/SRR17220977/SRR17220977_1_filtered.fastq,$DIR/SRR17220978/SRR17220978_1_filtered.fastq,$DIR/SRR17220979/SRR17220979_1_filtered.fastq -2 $DIR/SRR17220965/SRR17220965_2_filtered.fastq,$DIR/SRR17220966/SRR17220966_2_filtered.fastq,$DIR/SRR17220967/SRR17220967_2_filtered.fastq,$DIR/SRR17220968/SRR17220968_2_filtered.fastq,$DIR/SRR17220969/SRR17220969_2_filtered.fastq,$DIR/SRR17220970/SRR17220970_2_filtered.fastq,$DIR/SRR17220971/SRR17220971_2_filtered.fastq,$DIR/SRR17220972/SRR17220972_2_filtered.fastq,$DIR/SRR17220977/SRR17220977_2_filtered.fastq,$DIR/SRR17220978/SRR17220978_2_filtered.fastq,$DIR/SRR17220979/SRR17220979_2_filtered.fastq -o ${OUT}/SCHORN -t $CPU

#FRASER_2023

megahit -1 $DIR/SRR15353278/SRR15353278_1_filtered.fastq,$DIR/SRR15353279/SRR15353279_1_filtered.fastq,$DIR/SRR15353280/SRR15353280_1_filtered.fastq,$DIR/SRR15353281/SRR15353281_1_filtered.fastq,$DIR/SRR15353282/SRR15353282_1_filtered.fastq,$DIR/SRR15353283/SRR15353283_1_filtered.fastq,$DIR/SRR15353284/SRR15353284_1_filtered.fastq,$DIR/SRR15353285/SRR15353285_1_filtered.fastq,$DIR/SRR15353286/SRR15353286_1_filtered.fastq,$DIR/SRR15353287/SRR15353287_1_filtered.fastq,$DIR/SRR15353288/SRR15353288_1_filtered.fastq,$DIR/SRR15353289/SRR15353289_1_filtered.fastq,$DIR/SRR15353290/SRR15353290_1_filtered.fastq,$DIR/SRR15353291/SRR15353291_1_filtered.fastq,$DIR/SRR15353292/SRR15353292_1_filtered.fastq,$DIR/SRR15353293/SRR15353293_1_filtered.fastq,$DIR/SRR15353294/SRR15353294_1_filtered.fastq,$DIR/SRR15353295/SRR15353295_1_filtered.fastq -2 $DIR/SRR15353278/SRR15353278_2_filtered.fastq,$DIR/SRR15353279/SRR15353279_2_filtered.fastq,$DIR/SRR15353280/SRR15353280_2_filtered.fastq,$DIR/SRR15353281/SRR15353281_2_filtered.fastq,$DIR/SRR15353282/SRR15353282_2_filtered.fastq,$DIR/SRR15353283/SRR15353283_2_filtered.fastq,$DIR/SRR15353284/SRR15353284_2_filtered.fastq,$DIR/SRR15353285/SRR15353285_2_filtered.fastq,$DIR/SRR15353286/SRR15353286_2_filtered.fastq,$DIR/SRR15353287/SRR15353287_2_filtered.fastq,$DIR/SRR15353288/SRR15353288_2_filtered.fastq,$DIR/SRR15353289/SRR15353289_2_filtered.fastq,$DIR/SRR15353290/SRR15353290_2_filtered.fastq,$DIR/SRR15353291/SRR15353291_2_filtered.fastq,$DIR/SRR15353292/SRR15353292_2_filtered.fastq,$DIR/SRR15353293/SRR15353293_2_filtered.fastq,$DIR/SRR15353294/SRR15353294_2_filtered.fastq,$DIR/SRR15353295/SRR15353295_2_filtered.fastq -o ${OUT}/FRASER_2023 -t $CPU


